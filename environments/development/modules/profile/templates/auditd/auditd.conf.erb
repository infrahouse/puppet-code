# Managed by Puppet
# Auditd configuration for Ubuntu 24.04 (auditd 3.1.2+)
# All options verified against Ubuntu noble manpage

# Local event logging
local_events = yes
write_logs = yes

# Log file location
log_file = /var/log/audit/audit.log

# Log format (raw or enriched - enriched provides more detail for compliance)
log_format = enriched

# Log group (for permissions)
log_group = root

# Priority boost for daemon
priority_boost = 4

# Flush mode (incremental_async is default and recommended)
flush = incremental_async

# Frequency of writing to disk (in seconds)
freq = 20

# Number of logs to keep
num_logs = 10

# Action when disk space is low
space_left = 75
space_left_action = syslog
admin_space_left = 50
admin_space_left_action = suspend
disk_full_action = suspend
disk_error_action = suspend

# Maximum log file size (in MB)
max_log_file = 50
max_log_file_action = rotate

# Name format for multi-host environments
name_format = hostname
