# Managed by Puppet
# Logrotate configuration for audit logs
# Size-based rotation (auditd built-in rotation is disabled)

<%= File.dirname(@log_file) %>/*.log {
    size 50M
    rotate 10
    compress
    delaycompress
    notifempty
    missingok
    create <%= @log_file_mode %> <%= @log_file_owner %> <%= @log_file_group %>
    postrotate
        # Tell auditd to reopen its log file
        /usr/sbin/service auditd rotate
    endscript
}
