# Managed by Puppet
# Logrotate configuration for audit logs

<%= File.dirname(@log_file) %>/*.log {
    daily
    rotate 365
    compress
    delaycompress
    notifempty
    create <%= @log_file_mode %> <%= @log_file_owner %> <%= @log_file_group %>
    postrotate
        /usr/sbin/service auditd rotate
        # Reapply ACLs for CloudWatch agent access after rotation
        if [ -x /usr/local/bin/set-audit-acl ]; then
            /usr/local/bin/set-audit-acl
        fi
    endscript
}
